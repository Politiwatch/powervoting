{% extends "base.html" %}

{% block precontent %}
<h1 class="heading text-5xl mb-4 font-black">
    District Comparison
</h1>
{% include "picker.html" %}
{% endblock %}

{% block content %}
<script>
    let data = {{info|tojson}};
    let labels = data.map(x => `${x[0].input.state} District ${x[0].district} (${x[0].input.zip})`);
</script>
<div class="md:flex">
    <div class="md:sticky mb-8 top-1 mr-8 md:w-1/3 self-start">
        <h3 class="heading mb-2 font-black">Overall Results</h3>
        <p class="mb-2">Within the US, the power and impact of your vote varies depending on where you live. We
            calculate the voting power score for each address using the turnout, number of representatives, and
            historical closeness in federal elections.</p>
        <p>&ldquo;Power per vote&rdquo; (PPV) is the number of representatives (senator, congresspeople, and
            presidential electors) per vote. Higher numbers mean more impact per vote. See the <a
                href="#appendix">Appendix</a> for more information.</p>
    </div>
    <div class="md:w-2/3 self-start">
        <div class="card ~neutral !low">
            <p class="label mb-2">Average Voting Power Score <span
                class="text-neutral-600 text-xs">&times; 10<sup>6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading comparison" data-comparison-group="overall">
                        {{(data.total * 100) | round | string() | truncate(2, True, '', 0)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Average Power Per Vote <span
                class="text-neutral-600 text-xs">&times; 10<sup>-6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading text-xl comparison" data-comparison-group="overall-ppv">{{"%.2f"|format(data.ppv_total * 1000000)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Average Weighted Closeness <span
                class="text-neutral-600 text-xs">&times; 10<sup>-2</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading text-xl comparison" data-comparison-group="overall-closeness">{{"%.1f"|format(data.closeness_total * 100)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<hr class="sep md:h-14">
<div class="md:flex">
    <div class="md:sticky mb-8 top-1 mr-8 md:w-1/3 self-start">
        <h3 class="heading mb-2 font-black">House Results</h3>
        <p>The voting power score in a House election is calculated according to the election’s turnout and historical
            closeness. Higher numbers mean more voting power and more power per vote (PPV).</p>
    </div>
    <div class="md:w-2/3 self-start">
        <div class="card ~neutral !low">
            <p class="label mb-2">Voting Power Score <span
                class="text-neutral-600 text-xs">&times; 10<sup>6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading comparison" data-comparison-group="house">{{(data.house * 100) | round | string() | truncate(2, True, '', 0)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Power Per Vote <span
                class="text-neutral-600 text-xs">&times; 10<sup>-6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading text-xl comparison" data-comparison-group="house-ppv">{{"%.2f"|format(data.ppv_house * 1000000)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Closeness History</p>
            <canvas id="houseChart" height="100"></canvas>
            <script>buildChart(data.map(x => x[1].house_history), labels, "houseChart")</script>
        </div>
    </div>
</div>
<hr class="sep md:h-14">
<div class="md:flex">
    <div class="md:sticky mb-8 top-1 mr-8 md:w-1/3 self-start">
        <h3 class="heading mb-2 font-black">Senate Results</h3>
        <p>The voting power score in a Senate election is calculated according to the election’s turnout and historical
            closeness. PPV is proportional to the one senator up for election at a time. Higher numbers mean more voting
            power and more power per vote (PPV).
        </p>
    </div>
    <div class="md:w-2/3 self-start">
        <div class="card ~neutral !low">
            <p class="label mb-2">Voting Power Score <span
                class="text-neutral-600 text-xs">&times; 10<sup>6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading comparison" data-comparison-group="senate">{{(data.senate * 100) | round | string() | truncate(2, True, '', 0)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Power Per Vote <span
                class="text-neutral-600 text-xs">&times; 10<sup>-6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading text-xl comparison" data-comparison-group="senate-ppv">{{"%.2f"|format(data.ppv_senate * 1000000)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Closeness History</p>
            <canvas id="senateChart" height="100"></canvas>
            <script>buildChart(data.map(x => x[1].senate_history), labels, "senateChart")</script>
        </div>
    </div>
</div>
<hr class="sep md:h-14">
<div class="md:flex">
    <div class="md:sticky mb-8 top-1 mr-8 md:w-1/3 self-start">
        <h3 class="heading mb-2 font-black">Presidential Results</h3>
        <p>The voting power score in a Presidential election is calculated according to the election’s turnout and
            historical closeness. PPV is proportional to the state’s number of electors in the electoral college. Higher
            numbers mean more voting power and more power per vote (PPV).</p>
    </div>
    <div class="md:w-2/3 self-start">
        <div class="card ~neutral !low">
            <p class="label mb-2">Voting Power Score <span
                class="text-neutral-600 text-xs">&times; 10<sup>6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading comparison" data-comparison-group="president">{{(data.president * 100) | round | string() | truncate(2, True, '', 0)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Power Per Vote <span
                class="text-neutral-600 text-xs">&times; 10<sup>-6</sup></span></p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for loc, data in info %}
                <article class="w-full">
                    <p class="support">{{loc.state|upper}} District {{loc.district}} ({{loc.input.zip}})</p>
                    <h3 class="heading text-xl comparison" data-comparison-group="president-ppv">{{"%.2f"|format(data.ppv_president * 1000000)}}</h3>
                </article>
                {% endfor %}
            </div>
        </div>
        <hr class="sep h-4">
        <div class="card ~neutral !low">
            <p class="label mb-2">Closeness History</p>
            <canvas id="presidentChart" height="100"></canvas>
            <script>buildChart(data.map(x => x[1].president_history), labels, "presidentChart")</script>
        </div>
    </div>
</div>

{% endblock %}